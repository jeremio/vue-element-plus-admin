var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(a,t,n)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,i=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&o(e,t,a[t]);if(n)for(var t of n(a))s.call(a,t)&&o(e,t,a[t]);return e};import{r as l,J as c,q as p,m as u,a as g,a_ as m,bx as d,k as b,C as f}from"./index.aa2d114b.js";import{E as v}from"./el-message-box.754bcfdc.js";import"./el-button.92c2e8f8.js";import"./el-input.3aa0e129.js";import"./el-overlay.be1d10cf.js";const{t:y}=b(),P=e=>{const n=l({pageSize:10,currentPage:1,total:10,tableList:[],paramsObj:{},loading:!0,currentRow:null}),r=c((()=>{return{params:(e=i({},n.paramsObj.params),r={pageSize:n.pageSize,pageIndex:n.currentPage},a(e,t(r)))};var e,r}));p((()=>n.currentPage),(()=>{w.getList()})),p((()=>n.pageSize),(()=>{n.currentPage=1,w.getList()}));const s=u(),o=u(),b=async()=>{await f();const e=g(s);return e},P=async(a,t)=>{if(await((null==e?void 0:e.delListApi)&&(null==e?void 0:e.delListApi(a)))){d.success(y("common.delSuccess"));const e=(n.total%n.pageSize===t.length||1===n.pageSize)&&n.currentPage>1?n.currentPage-1:n.currentPage;n.currentPage=e,w.getList()}},w={getList:async()=>{var a;n.loading=!0;const t=await(null==e?void 0:e.getListApi(g(r)).catch((()=>{})).finally((()=>{n.loading=!1})));t&&(n.tableList=m(t.data||{},null==e?void 0:e.response.list),n.total=m(t.data||{},null==(a=null==e?void 0:e.response)?void 0:a.total)||0)},setProps:async(e={})=>{const a=await b();null==a||a.setProps(e)},setColumn:async e=>{const a=await b();null==a||a.setColumn(e)},getSelections:async()=>{const e=await b();return(null==e?void 0:e.selections)||[]},setSearchParams:e=>{n.currentPage=1,n.paramsObj=Object.assign(n.paramsObj,{params:i({pageSize:n.pageSize,pageIndex:n.currentPage},e)}),w.getList()},delList:async(e,a,t=!0)=>{const r=await b();if(a){if(!(null==r?void 0:r.selections.length))return void d.warning(y("common.delNoData"))}else if(!n.currentRow)return void d.warning(y("common.delNoData"));const s={data:{ids:e}};t?v.confirm(y("common.delMessage"),y("common.delWarning"),{confirmButtonText:y("common.delOk"),cancelButtonText:y("common.delCancel"),type:"warning"}).then((async()=>{await P(s,e)})).catch((()=>{})):await P(s,e)}};return(null==e?void 0:e.props)&&w.setProps(e.props),{register:(e,a)=>{s.value=e,o.value=a},elTableRef:o,tableObject:n,methods:w}};export{P as u};
